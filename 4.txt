1) функция SWAP должна иметь вид x^= y^= x^= y, функция в условии некорректна
2) printf в несколько строчек(14-16 строки)
3)спецификатор %d в 17 строке, хотя a unsigned long
4)23-24 строчки- отсутсвие спецификатора
5) 29 строка- отсутсвие проверки корректности выделения памяти и отсутсвие умножения на sizeof(...)